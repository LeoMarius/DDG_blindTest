<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">




    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- JqueryUI CSS -->
    <link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
    <!-- Bootstrap Core CSS  -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Custom CSS 
    <link href="css/simple-sidebar.css" rel="stylesheet">

    <!-- Mes Propres CSS "temporaires" -->
    <link rel="stylesheet" href="css/blindTest.css">

    <style type="text/css">

    </style>

    <!-- Fin de mes CSS -->


</head>

<body>

    <!-- ce bloc caché qui lit la musique deezer -->
    <div id="dz-root"></div>
    <br>



    <!-- Boutons de chargement de playlist -->
    <div class="">
        <form id="playlistLoader" class="formulaires">
            Identifiant Deezer de la playlist
            <input id='playlistNumber' type="text" name="playlistNumber">
            <input type="checkbox" name="random" id="playlistShuffle">
            <input id="summitPlaylist" type="button" value="Charger la Playlist"> 1006743821 - 579649831 (d) - 1109890291 - 524654575 - 60933168
        </form>
    </div>

    <!-- Boutons de creation de joueurs -->
    <div>
        <form id="playerCreator" class="formulaires">
            Nom du personnage
            <input id='playerName' type="text" name="playerName">
            <input id="summitPlayer" type="button" value="Créer un nouveau joueur">
        </form>
    </div>



    <br/>
    <br/>





    <!-- Le bloc de contrôle avec les boutons -->
    <div id="controlers" class="draggable">

        <input type="button" id="StartMain" value="Le Gros start !" />
        <input type="button" onclick="DZ.player.playAlbum(301775); return false;" value="Play Daft Punk - Homework" />
        <br/>
        <input type="button" onclick="DZ.player.play(); return false;" value="play" />
        <input type="button" onclick="DZ.player.pause(); return false;" value="pause" />
        <input type="button" onclick="DZ.player.prev(); return false;" value="prev" />
        <input type="button" onclick="DZ.player.next(); return false;" value="next" />
        <br/>
        <input type="button" id="buttonDebug1" value="debug 1" />
        <input type="button" id="buttonDebug2" value="debug 2" />
        <input type="button" id="buttonDebug3" value="debug 3" />

        <br/>
        <br/>
        <br/>
    </div>

    <!-- Là je commente -->





    <!-- Cercle de lecture principal -->
    <div id="circle" class="circle draggable" data-value="0" data-size="300" data-thickness="15" data-animation-start-value="0" data-reverse="false">
        <div id="texteLoading">Drag me around</div>
    </div>

    <br/>

    <!-- Barre de progression Deezer -->
    <div id="slider_seek" class="progressbarplay" style="">
        <div class="bar" style="width: 0%;"></div>
    </div>




    <!-- Joueur temporaire, test de structure -->
    <div id="player2" class="player draggable">

        <button type="button" id="player1Kill" class="close" data-dismiss="modal">x</button>

        <div id="circlePlayer2" class="circle playerCircle" data-value="0.1" data-size="100" data-thickness="10" data-animation-start-value="0" data-reverse="false">
        </div>

        <div class="playersTexts">

            <strong>ID :</strong> <em class="playerID"> 2</em>
            <br>
            <strong>Nom :</strong> <em class="playerName"> Player2</em>
            <br>
            <strong>Score :</strong> <em class="playerScore"> 0</em>
            <br>
            <strong>Touche assignée :</strong> <em data-toggle="modal" href="#fenetreModale" class="playerTouche">Unassigned </em>
            <br>

            <strong>Cris de guerre :</strong>
            <select class="playerSound">
                <option></option>
                <option>Ane</option>
                <option>Chat</option>
            </select>


        </div>


    </div>



    <audio src="sons/ane.mp3"></audio>
    <audio src="sons/chat3.mp3"></audio>

    <!-- POP UP -->
    <div class="modal" id="fenetreModale">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">x</button>
                    <h4 class="modal-title">Configuration</h4>
                </div>
                <div class="modal-body">
                    Appuyez sur une touche
                </div>
            </div>
        </div>
    </div>



    <button data-toggle="modal" href="#validationPoints" class="btn btn-primary">Informations</button>
    
    <div class="modal" id="validationPoints">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">x</button>
                    <h4 class="modal-title">Tada !</h4>
                </div>
                <div class="modal-body">
                    Validation de la réponse !
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" data-dismiss="modal">NUL ! -1pts</button>
                    <button class="btn btn-info" data-dismiss="modal">Mouai... 0pts</button>
                    <button class="btn btn-success" data-dismiss="modal">Bravo ! +1pts</button>
                    
                </div>
            </div>
        </div>
    </div>






    <!-- Là j'appel tous les scripts/libraries trucs -->

    <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script type="text/javascript" src="http://e-cdn-files.deezer.com/js/min/dz.js"></script>
    <script type="text/javascript" src="js/circle-progress.js"></script>


    <!-- Mes JS persos séparés pour y voir plus clair -->
    <script type="text/javascript" src="js/boutons.js"></script>
    <script type="text/javascript" src="js/clavier.js"></script>


    <!-- Et là je fait ma bricole -->

    <script>
        /// Mes variables globales

        var currentPlaylist = 579649831; /// La playlist préchargée

        var Joueurs = []; /// Le tableau qui contient les informations des joueurs

        /// Initialisation des ID des joueurs
        var playerId = 1;

        /// Player en cours d'édition
        var activePlayerId = 0;

        /// Position dans le tableau Joueurs du player actif
        var activeJoueur = 0;

        /// Configuration des touches possible
        var playerKeyConfig = false;


        var sonAne = new Audio('sons/ane.mp3');
        var sonChat = new Audio('sons/chat3.mp3');

        var playSound =
            function () {
                var temporaire = $('#player' + activePlayerId + ' .playersTexts .playerSound option:selected').text();
                if (temporaire == 'Ane') {
                    sonAne.play();
                };
                if (temporaire == 'Chat') {
                    sonChat.play();
                };
                console.log(temporaire);
            }


        /// Là je sais pas trop
        var pisteMusicale = {
            init: function (id) {
                this.id = id; //ID Deezer
                //  var currentTrack = DZ.player.getCurrentTrack();
                DZ.player.playTracks[(id)];
                var tempTrack = DZ.player.getCurrentTrack();
                this.title = tempTrack.title;
                this.artist = tempTrack.artist.name;
                this.album = tempTrack.album.title;
                this.duration = tempTrack.duration;
                this.played = false; //false (default)  or true
                // DZ.player.playTracks[(currentTrack.id)];
            }
        };



        //// DEFINITION D'UN PLAYER
        var Personnage = {
            id: 0,
            nom: "",
            score: 0,
            avatar: false,
            avatarHref: "",
            keyAssigned: "",
            // Initialise le personnage
            init: function (id, nom) {
                this.id = id;
                this.nom = nom;
                this.score = 0;
                this.avatar = false;
                this.avatarHref = "";
                this.keyAssigned = "";
            },
            // Renvoie la description du personnage
            decrire: function () {
                var description = this.nom + " a " + this.score + " points. Il a l'ID : " + this.id;
                console.log(description);
            }
        };




        ///Fonction pour initialiser les éléments JS d'un Player
        function initPlayer() {
            $(".draggable").draggable();
            $('.playerCircle').circleProgress({
                fill: {
                    gradient: ["green", "blue"]
                },
                animation: {
                    duration: 1200
                },
                lineCap: "round" /// les bouts arrondis :)
            });
        };


        /// Fonction pour mettre en pause la musique
        function pauseMusic() {
            var playerPlaying = DZ.player.isPlaying();
            if (playerPlaying == true) {
                DZ.player.pause();
                console.log('Paused');
                return false;
            }
        };

        function playMusic() {
            var playerPlaying = DZ.player.isPlaying();
            if (playerPlaying == false) {
                DZ.player.play();
                console.log('Cey partis pour le show!');
                return false;
            }
        };





        /////  DEBUT DE LA BOUCLE PRINCIPALE JQuery  /////
        $(document).ready(function () {







            $("#controlers input").attr('disabled', true);


            /// Le clic sur la barre horizontale
            $("#slider_seek").click(function (evt, arg) {
                var left = evt.offsetX;
                console.log(evt.offsetX, $(this).width(), evt.offsetX / $(this).width());
                DZ.player.seek((evt.offsetX / $(this).width()) * 100);
            });



            //rendre draggable certains trucs
            $(".draggable").draggable();


            //// INITIALISATION DU CERCLE DE CHARGEMENT
            $('#circle').circleProgress({
                fill: {
                    gradient: ["red", "orange"]
                },
                animation: {
                    duration: 0
                },
                lineCap: "round" /// les bouts arrondis :)
            });

            $('.playerCircle').circleProgress({
                fill: {
                    gradient: ["green", "blue"]
                },
                animation: {
                    duration: 1200
                },
                lineCap: "round" /// les bouts arrondis :)
            });
            //Fin des cercles de chargement





        });




        /////  FIN DE LA BOUCLE PRINCIPALE JQuery  /////



        function event_listener_append() {
            var pre = document.getElementById('event_listener');
            var line = [];
            for (var i = 0; i < arguments.length; i++) {
                line.push(arguments[i]);
            }
            pre.innerHTML += line.join(' ') + "\n";
        };

        function onPlayerLoaded() {
            $("#controlers input").attr('disabled', false);
            event_listener_append('player_loaded');
            DZ.Event.subscribe('current_track', function (arg) {
                event_listener_append('current_track', arg.index, arg.track.title, arg.track.album.title);
            });




            /// Mise à jours de l'avancement des barres de progression
            DZ.Event.subscribe('player_position', function (arg) {
                //   event_listener_append('position', arg[0], arg[1]);

                ////Barre basique
                $("#slider_seek").find('.bar').css('width', (100 * arg[0] / arg[1]) + '%');

                ///Barre circulaire
                $('#circle').circleProgress('value', (arg[0] / arg[1]));

                var secondes = parseInt(arg[0]);
                $('#texteLoading').text(secondes);


            });






            DZ.Event.subscribe('track_end', function () {
                event_listener_append('track_end');
            });
        };

        DZ.init({
            appId: '8',
            channelUrl: 'http://developers.deezer.com/examples/channel.php',
            player: {
                onload: onPlayerLoaded
            }
        });
    </script>
    <pre id="event_listener" style="height:100px;overflow:auto;"></pre>
</body>

</html>




<!--  Utilisation de codes tiers :

API Deezer : https://github.com/deezer/javascript-samples




-->